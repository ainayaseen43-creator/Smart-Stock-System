{% extends "base.html" %}
{% block content %}

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Market Analysis</title>

<style>
body{
    background:#0b1220;
    color:#e5e7eb;
    font-family: "Segoe UI", Tahoma, sans-serif;
}

/* Title */
.title{
    font-size:26px;
    font-weight:700;
    color:#3b82f6;
    margin-bottom:4px;
}
.subtitle{
    font-size:13px;
    color:#9ca3af;
    margin-bottom:20px;
}

/* Table */
.table-box{
    background:#0f172a;
    border-radius:12px;
    overflow:hidden;
    border:1px solid #1e293b;
}

table{
    width:100%;
    border-collapse:collapse;
}

thead{
    background:#1e3a8a;
}

th{
    padding:14px;
    text-align:left;
    font-size:14px;
    color:#e0e7ff;
    letter-spacing:0.5px;
}

td{
    padding:12px 14px;
    border-bottom:1px solid #1e293b;
    font-size:14px;
}

tr:hover{
    background:#020617;
}

/* Colors */
.price{
    color:#38bdf8;
    font-weight:600;
}
.high{
    color:#22c55e;
}
.low{
    color:#ef4444;
}

/* Loading */
.loading{
    text-align:center;
    padding:25px;
    color:#60a5fa;
    font-size:14px;
}
</style>
</head>

<body>

<div class="title">Market Analysis</div>
<div class="subtitle">
Daily High • Low • Close (Real-Time Market Data)
</div>

<div class="table-box">
<table>
    <thead>
        <tr>
            <th>Symbol</th>
            <th>Current (Close)</th>
            <th>Day High</th>
            <th>Day Low</th>
        </tr>
    </thead>
    <tbody id="marketTable">
        <tr>
            <td colspan="4" class="loading">Loading market data...</td>
        </tr>
    </tbody>
</table>
</div>

<script>
fetch("/api/market-analysis")
  .then(res => res.json())
  .then(res => {
      const tbody = document.getElementById("marketTable");
      tbody.innerHTML = "";

      if (!res.data || res.data.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="4" class="loading">No market data available</td>
            </tr>`;
          return;
      }

      res.data.forEach(stock => {
          tbody.innerHTML += `
            <tr>
              <td><strong>${stock.symbol}</strong></td>
              <td class="price">$${stock.current}</td>
              <td class="high">$${stock.high}</td>
              <td class="low">$${stock.low}</td>
            </tr>
          `;
      });
  })
  .catch(() => {
      document.getElementById("marketTable").innerHTML = `
        <tr>
          <td colspan="4" class="loading">Failed to load data</td>
        </tr>`;
  });
</script>

</body>
</html>

{% endblock %}
